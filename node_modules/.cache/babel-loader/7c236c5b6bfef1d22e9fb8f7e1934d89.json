{"ast":null,"code":"function _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport AddButton from \"../AddButton\";\nimport IconButton from \"../IconButton\";\nimport React, { Component } from \"react\";\nimport includes from \"core-js-pure/es/array/includes\";\nimport * as types from \"../../types\";\nimport { getWidget, getDefaultFormState, getUiOptions, isMultiSelect, isFilesArray, isFixedItems, allowAdditionalItems, optionsList, retrieveSchema, toIdSchema, getDefaultRegistry } from \"../../utils\";\nimport { nanoid } from \"nanoid\";\n\nfunction ArrayFieldTitle(_ref) {\n  var TitleField = _ref.TitleField,\n      idSchema = _ref.idSchema,\n      title = _ref.title,\n      required = _ref.required;\n\n  if (!title) {\n    return null;\n  }\n\n  var id = \"\".concat(idSchema.$id, \"__title\");\n  return React.createElement(TitleField, {\n    id: id,\n    title: title,\n    required: required\n  });\n}\n\nfunction ArrayFieldDescription(_ref2) {\n  var DescriptionField = _ref2.DescriptionField,\n      idSchema = _ref2.idSchema,\n      description = _ref2.description;\n\n  if (!description) {\n    return null;\n  }\n\n  var id = \"\".concat(idSchema.$id, \"__description\");\n  return React.createElement(DescriptionField, {\n    id: id,\n    description: description\n  });\n} // Used in the two templates\n\n\nfunction DefaultArrayItem(props) {\n  var btnStyle = {\n    flex: 1,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"bold\"\n  };\n  return React.createElement(\"div\", {\n    key: props.key,\n    className: props.className\n  }, React.createElement(\"div\", {\n    className: props.hasToolbar ? \"col-xs-9\" : \"col-xs-12\"\n  }, props.children), props.hasToolbar && React.createElement(\"div\", {\n    className: \"col-xs-3 array-item-toolbox\"\n  }, React.createElement(\"div\", {\n    className: \"btn-group\",\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-around\"\n    }\n  }, (props.hasMoveUp || props.hasMoveDown) && React.createElement(IconButton, {\n    icon: \"arrow-up\",\n    \"aria-label\": \"Move up\",\n    className: \"array-item-move-up\",\n    tabIndex: \"-1\",\n    style: btnStyle,\n    disabled: props.disabled || props.readonly || !props.hasMoveUp,\n    onClick: props.onReorderClick(props.index, props.index - 1)\n  }), (props.hasMoveUp || props.hasMoveDown) && React.createElement(IconButton, {\n    icon: \"arrow-down\",\n    className: \"array-item-move-down\",\n    \"aria-label\": \"Move down\",\n    tabIndex: \"-1\",\n    style: btnStyle,\n    disabled: props.disabled || props.readonly || !props.hasMoveDown,\n    onClick: props.onReorderClick(props.index, props.index + 1)\n  }), props.hasRemove && React.createElement(IconButton, {\n    type: \"danger\",\n    icon: \"remove\",\n    \"aria-label\": \"Remove\",\n    className: \"array-item-remove\",\n    tabIndex: \"-1\",\n    style: btnStyle,\n    disabled: props.disabled || props.readonly,\n    onClick: props.onDropIndexClick(props.index)\n  }))));\n}\n\nfunction DefaultFixedArrayFieldTemplate(props) {\n  return React.createElement(\"fieldset\", {\n    className: props.className,\n    id: props.idSchema.$id\n  }, React.createElement(ArrayFieldTitle, {\n    key: \"array-field-title-\".concat(props.idSchema.$id),\n    TitleField: props.TitleField,\n    idSchema: props.idSchema,\n    title: props.uiSchema[\"ui:title\"] || props.title,\n    required: props.required\n  }), (props.uiSchema[\"ui:description\"] || props.schema.description) && React.createElement(\"div\", {\n    className: \"field-description\",\n    key: \"field-description-\".concat(props.idSchema.$id)\n  }, props.uiSchema[\"ui:description\"] || props.schema.description), React.createElement(\"div\", {\n    className: \"row array-item-list\",\n    key: \"array-item-list-\".concat(props.idSchema.$id)\n  }, props.items && props.items.map(DefaultArrayItem)), props.canAdd && React.createElement(AddButton, {\n    className: \"array-item-add\",\n    onClick: props.onAddClick,\n    disabled: props.disabled || props.readonly\n  }));\n}\n\nfunction DefaultNormalArrayFieldTemplate(props) {\n  return React.createElement(\"fieldset\", {\n    className: props.className,\n    id: props.idSchema.$id\n  }, React.createElement(ArrayFieldTitle, {\n    key: \"array-field-title-\".concat(props.idSchema.$id),\n    TitleField: props.TitleField,\n    idSchema: props.idSchema,\n    title: props.uiSchema[\"ui:title\"] || props.title,\n    required: props.required\n  }), (props.uiSchema[\"ui:description\"] || props.schema.description) && React.createElement(ArrayFieldDescription, {\n    key: \"array-field-description-\".concat(props.idSchema.$id),\n    DescriptionField: props.DescriptionField,\n    idSchema: props.idSchema,\n    description: props.uiSchema[\"ui:description\"] || props.schema.description\n  }), React.createElement(\"div\", {\n    className: \"row array-item-list\",\n    key: \"array-item-list-\".concat(props.idSchema.$id)\n  }, props.items && props.items.map(function (p) {\n    return DefaultArrayItem(p);\n  })), props.canAdd && React.createElement(AddButton, {\n    className: \"array-item-add\",\n    onClick: props.onAddClick,\n    disabled: props.disabled || props.readonly\n  }));\n}\n\nfunction generateRowId() {\n  return nanoid();\n}\n\nfunction generateKeyedFormData(formData) {\n  return !Array.isArray(formData) ? [] : formData.map(function (item) {\n    return {\n      key: generateRowId(),\n      item: item\n    };\n  });\n}\n\nfunction keyedToPlainFormData(keyedFormData) {\n  return keyedFormData.map(function (keyedItem) {\n    return keyedItem.item;\n  });\n}\n\nvar ArrayField = /*#__PURE__*/function (_Component) {\n  _inherits(ArrayField, _Component);\n\n  function ArrayField(props) {\n    var _this;\n\n    _classCallCheck(this, ArrayField);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ArrayField).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"_getNewFormDataRow\", function () {\n      var _this$props = _this.props,\n          schema = _this$props.schema,\n          _this$props$registry = _this$props.registry,\n          registry = _this$props$registry === void 0 ? getDefaultRegistry() : _this$props$registry;\n      var rootSchema = registry.rootSchema;\n      var itemSchema = schema.items;\n\n      if (isFixedItems(schema) && allowAdditionalItems(schema)) {\n        itemSchema = schema.additionalItems;\n      }\n\n      return getDefaultFormState(itemSchema, undefined, rootSchema);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onAddClick\", function (event) {\n      if (event) {\n        event.preventDefault();\n      }\n\n      var onChange = _this.props.onChange;\n      var newKeyedFormDataRow = {\n        key: generateRowId(),\n        item: _this._getNewFormDataRow()\n      };\n      var newKeyedFormData = [].concat(_toConsumableArray(_this.state.keyedFormData), [newKeyedFormDataRow]);\n\n      _this.setState({\n        keyedFormData: newKeyedFormData,\n        updatedKeyedFormData: true\n      }, function () {\n        return onChange(keyedToPlainFormData(newKeyedFormData));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onAddIndexClick\", function (index) {\n      return function (event) {\n        if (event) {\n          event.preventDefault();\n        }\n\n        var onChange = _this.props.onChange;\n        var newKeyedFormDataRow = {\n          key: generateRowId(),\n          item: _this._getNewFormDataRow()\n        };\n\n        var newKeyedFormData = _toConsumableArray(_this.state.keyedFormData);\n\n        newKeyedFormData.splice(index, 0, newKeyedFormDataRow);\n\n        _this.setState({\n          keyedFormData: newKeyedFormData,\n          updatedKeyedFormData: true\n        }, function () {\n          return onChange(keyedToPlainFormData(newKeyedFormData));\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onDropIndexClick\", function (index) {\n      return function (event) {\n        if (event) {\n          event.preventDefault();\n        }\n\n        var onChange = _this.props.onChange;\n        var keyedFormData = _this.state.keyedFormData; // refs #195: revalidate to ensure properly reindexing errors\n\n        var newErrorSchema;\n\n        if (_this.props.errorSchema) {\n          newErrorSchema = {};\n          var errorSchema = _this.props.errorSchema;\n\n          for (var i in errorSchema) {\n            i = parseInt(i);\n\n            if (i < index) {\n              newErrorSchema[i] = errorSchema[i];\n            } else if (i > index) {\n              newErrorSchema[i - 1] = errorSchema[i];\n            }\n          }\n        }\n\n        var newKeyedFormData = keyedFormData.filter(function (_, i) {\n          return i !== index;\n        });\n\n        _this.setState({\n          keyedFormData: newKeyedFormData,\n          updatedKeyedFormData: true\n        }, function () {\n          return onChange(keyedToPlainFormData(newKeyedFormData), newErrorSchema);\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onReorderClick\", function (index, newIndex) {\n      return function (event) {\n        if (event) {\n          event.preventDefault();\n          event.target.blur();\n        }\n\n        var onChange = _this.props.onChange;\n        var newErrorSchema;\n\n        if (_this.props.errorSchema) {\n          newErrorSchema = {};\n          var errorSchema = _this.props.errorSchema;\n\n          for (var i in errorSchema) {\n            if (i == index) {\n              newErrorSchema[newIndex] = errorSchema[index];\n            } else if (i == newIndex) {\n              newErrorSchema[index] = errorSchema[newIndex];\n            } else {\n              newErrorSchema[i] = errorSchema[i];\n            }\n          }\n        }\n\n        var keyedFormData = _this.state.keyedFormData;\n\n        function reOrderArray() {\n          // Copy item\n          var _newKeyedFormData = keyedFormData.slice(); // Moves item from index to newIndex\n\n\n          _newKeyedFormData.splice(index, 1);\n\n          _newKeyedFormData.splice(newIndex, 0, keyedFormData[index]);\n\n          return _newKeyedFormData;\n        }\n\n        var newKeyedFormData = reOrderArray();\n\n        _this.setState({\n          keyedFormData: newKeyedFormData\n        }, function () {\n          return onChange(keyedToPlainFormData(newKeyedFormData), newErrorSchema);\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeForIndex\", function (index) {\n      return function (value, errorSchema) {\n        var _this$props2 = _this.props,\n            formData = _this$props2.formData,\n            onChange = _this$props2.onChange;\n        var newFormData = formData.map(function (item, i) {\n          // We need to treat undefined items as nulls to have validation.\n          // See https://github.com/tdegrunt/jsonschema/issues/206\n          var jsonValue = typeof value === \"undefined\" ? null : value;\n          return index === i ? jsonValue : item;\n        });\n        onChange(newFormData, errorSchema && _this.props.errorSchema && _objectSpread({}, _this.props.errorSchema, _defineProperty({}, index, errorSchema)));\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSelectChange\", function (value) {\n      _this.props.onChange(value);\n    });\n\n    var _formData = props.formData;\n\n    var _keyedFormData = generateKeyedFormData(_formData);\n\n    _this.state = {\n      keyedFormData: _keyedFormData,\n      updatedKeyedFormData: false\n    };\n    return _this;\n  }\n\n  _createClass(ArrayField, [{\n    key: \"isItemRequired\",\n    value: function isItemRequired(itemSchema) {\n      if (Array.isArray(itemSchema.type)) {\n        // While we don't yet support composite/nullable jsonschema types, it's\n        // future-proof to check for requirement against these.\n        return !includes(itemSchema.type, \"null\");\n      } // All non-null array item types are inherently required by design\n\n\n      return itemSchema.type !== \"null\";\n    }\n  }, {\n    key: \"canAddItem\",\n    value: function canAddItem(formItems) {\n      var _this$props3 = this.props,\n          schema = _this$props3.schema,\n          uiSchema = _this$props3.uiSchema;\n\n      var _getUiOptions = getUiOptions(uiSchema),\n          addable = _getUiOptions.addable;\n\n      if (addable !== false) {\n        // if ui:options.addable was not explicitly set to false, we can add\n        // another item if we have not exceeded maxItems yet\n        if (schema.maxItems !== undefined) {\n          addable = formItems.length < schema.maxItems;\n        } else {\n          addable = true;\n        }\n      }\n\n      return addable;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props4 = this.props,\n          schema = _this$props4.schema,\n          uiSchema = _this$props4.uiSchema,\n          idSchema = _this$props4.idSchema,\n          _this$props4$registry = _this$props4.registry,\n          registry = _this$props4$registry === void 0 ? getDefaultRegistry() : _this$props4$registry;\n      var rootSchema = registry.rootSchema;\n\n      if (!schema.hasOwnProperty(\"items\")) {\n        var fields = registry.fields;\n        var UnsupportedField = fields.UnsupportedField;\n        return React.createElement(UnsupportedField, {\n          schema: schema,\n          idSchema: idSchema,\n          reason: \"Missing items definition\"\n        });\n      }\n\n      if (isFixedItems(schema)) {\n        return this.renderFixedArray();\n      }\n\n      if (isFilesArray(schema, uiSchema, rootSchema)) {\n        return this.renderFiles();\n      }\n\n      if (isMultiSelect(schema, rootSchema)) {\n        return this.renderMultiSelect();\n      }\n\n      return this.renderNormalArray();\n    }\n  }, {\n    key: \"renderNormalArray\",\n    value: function renderNormalArray() {\n      var _this2 = this;\n\n      var _this$props5 = this.props,\n          schema = _this$props5.schema,\n          uiSchema = _this$props5.uiSchema,\n          errorSchema = _this$props5.errorSchema,\n          idSchema = _this$props5.idSchema,\n          name = _this$props5.name,\n          required = _this$props5.required,\n          disabled = _this$props5.disabled,\n          readonly = _this$props5.readonly,\n          autofocus = _this$props5.autofocus,\n          _this$props5$registry = _this$props5.registry,\n          registry = _this$props5$registry === void 0 ? getDefaultRegistry() : _this$props5$registry,\n          onBlur = _this$props5.onBlur,\n          onFocus = _this$props5.onFocus,\n          idPrefix = _this$props5.idPrefix,\n          rawErrors = _this$props5.rawErrors;\n      var title = schema.title === undefined ? name : schema.title;\n      var ArrayFieldTemplate = registry.ArrayFieldTemplate,\n          rootSchema = registry.rootSchema,\n          fields = registry.fields,\n          formContext = registry.formContext;\n      var TitleField = fields.TitleField,\n          DescriptionField = fields.DescriptionField;\n      var itemsSchema = retrieveSchema(schema.items, rootSchema);\n      var formData = keyedToPlainFormData(this.state.keyedFormData);\n      var arrayProps = {\n        canAdd: this.canAddItem(formData),\n        items: this.state.keyedFormData.map(function (keyedItem, index) {\n          var key = keyedItem.key,\n              item = keyedItem.item;\n          var itemSchema = retrieveSchema(schema.items, rootSchema, item);\n          var itemErrorSchema = errorSchema ? errorSchema[index] : undefined;\n          var itemIdPrefix = idSchema.$id + \"_\" + index;\n          var itemIdSchema = toIdSchema(itemSchema, itemIdPrefix, rootSchema, item, idPrefix);\n          return _this2.renderArrayFieldItem({\n            key: key,\n            index: index,\n            canMoveUp: index > 0,\n            canMoveDown: index < formData.length - 1,\n            itemSchema: itemSchema,\n            itemIdSchema: itemIdSchema,\n            itemErrorSchema: itemErrorSchema,\n            itemData: item,\n            itemUiSchema: uiSchema.items,\n            autofocus: autofocus && index === 0,\n            onBlur: onBlur,\n            onFocus: onFocus\n          });\n        }),\n        className: \"field field-array field-array-of-\".concat(itemsSchema.type),\n        DescriptionField: DescriptionField,\n        disabled: disabled,\n        idSchema: idSchema,\n        uiSchema: uiSchema,\n        onAddClick: this.onAddClick,\n        readonly: readonly,\n        required: required,\n        schema: schema,\n        title: title,\n        TitleField: TitleField,\n        formContext: formContext,\n        formData: formData,\n        rawErrors: rawErrors,\n        registry: registry\n      }; // Check if a custom render function was passed in\n\n      var Component = uiSchema[\"ui:ArrayFieldTemplate\"] || ArrayFieldTemplate || DefaultNormalArrayFieldTemplate;\n      return React.createElement(Component, arrayProps);\n    }\n  }, {\n    key: \"renderMultiSelect\",\n    value: function renderMultiSelect() {\n      var _this$props6 = this.props,\n          schema = _this$props6.schema,\n          idSchema = _this$props6.idSchema,\n          uiSchema = _this$props6.uiSchema,\n          formData = _this$props6.formData,\n          disabled = _this$props6.disabled,\n          readonly = _this$props6.readonly,\n          required = _this$props6.required,\n          placeholder = _this$props6.placeholder,\n          autofocus = _this$props6.autofocus,\n          onBlur = _this$props6.onBlur,\n          onFocus = _this$props6.onFocus,\n          _this$props6$registry = _this$props6.registry,\n          registry = _this$props6$registry === void 0 ? getDefaultRegistry() : _this$props6$registry,\n          rawErrors = _this$props6.rawErrors,\n          name = _this$props6.name;\n      var items = this.props.formData;\n      var widgets = registry.widgets,\n          rootSchema = registry.rootSchema,\n          formContext = registry.formContext;\n      var itemsSchema = retrieveSchema(schema.items, rootSchema, formData);\n      var title = schema.title || name;\n      var enumOptions = optionsList(itemsSchema);\n\n      var _getUiOptions$enumOpt = _objectSpread({}, getUiOptions(uiSchema), {\n        enumOptions: enumOptions\n      }),\n          _getUiOptions$enumOpt2 = _getUiOptions$enumOpt.widget,\n          widget = _getUiOptions$enumOpt2 === void 0 ? \"select\" : _getUiOptions$enumOpt2,\n          options = _objectWithoutProperties(_getUiOptions$enumOpt, [\"widget\"]);\n\n      var Widget = getWidget(schema, widget, widgets);\n      return React.createElement(Widget, {\n        id: idSchema && idSchema.$id,\n        multiple: true,\n        onChange: this.onSelectChange,\n        onBlur: onBlur,\n        onFocus: onFocus,\n        options: options,\n        schema: schema,\n        registry: registry,\n        value: items,\n        disabled: disabled,\n        readonly: readonly,\n        required: required,\n        label: title,\n        placeholder: placeholder,\n        formContext: formContext,\n        autofocus: autofocus,\n        rawErrors: rawErrors\n      });\n    }\n  }, {\n    key: \"renderFiles\",\n    value: function renderFiles() {\n      var _this$props7 = this.props,\n          schema = _this$props7.schema,\n          uiSchema = _this$props7.uiSchema,\n          idSchema = _this$props7.idSchema,\n          name = _this$props7.name,\n          disabled = _this$props7.disabled,\n          readonly = _this$props7.readonly,\n          autofocus = _this$props7.autofocus,\n          onBlur = _this$props7.onBlur,\n          onFocus = _this$props7.onFocus,\n          _this$props7$registry = _this$props7.registry,\n          registry = _this$props7$registry === void 0 ? getDefaultRegistry() : _this$props7$registry,\n          rawErrors = _this$props7.rawErrors;\n      var title = schema.title || name;\n      var items = this.props.formData;\n      var widgets = registry.widgets,\n          formContext = registry.formContext;\n\n      var _getUiOptions2 = getUiOptions(uiSchema),\n          _getUiOptions2$widget = _getUiOptions2.widget,\n          widget = _getUiOptions2$widget === void 0 ? \"files\" : _getUiOptions2$widget,\n          options = _objectWithoutProperties(_getUiOptions2, [\"widget\"]);\n\n      var Widget = getWidget(schema, widget, widgets);\n      return React.createElement(Widget, {\n        options: options,\n        id: idSchema && idSchema.$id,\n        multiple: true,\n        onChange: this.onSelectChange,\n        onBlur: onBlur,\n        onFocus: onFocus,\n        schema: schema,\n        title: title,\n        value: items,\n        disabled: disabled,\n        readonly: readonly,\n        formContext: formContext,\n        autofocus: autofocus,\n        rawErrors: rawErrors\n      });\n    }\n  }, {\n    key: \"renderFixedArray\",\n    value: function renderFixedArray() {\n      var _this3 = this;\n\n      var _this$props8 = this.props,\n          schema = _this$props8.schema,\n          uiSchema = _this$props8.uiSchema,\n          formData = _this$props8.formData,\n          errorSchema = _this$props8.errorSchema,\n          idPrefix = _this$props8.idPrefix,\n          idSchema = _this$props8.idSchema,\n          name = _this$props8.name,\n          required = _this$props8.required,\n          disabled = _this$props8.disabled,\n          readonly = _this$props8.readonly,\n          autofocus = _this$props8.autofocus,\n          _this$props8$registry = _this$props8.registry,\n          registry = _this$props8$registry === void 0 ? getDefaultRegistry() : _this$props8$registry,\n          onBlur = _this$props8.onBlur,\n          onFocus = _this$props8.onFocus,\n          rawErrors = _this$props8.rawErrors;\n      var title = schema.title || name;\n      var items = this.props.formData;\n      var ArrayFieldTemplate = registry.ArrayFieldTemplate,\n          rootSchema = registry.rootSchema,\n          fields = registry.fields,\n          formContext = registry.formContext;\n      var TitleField = fields.TitleField;\n      var itemSchemas = schema.items.map(function (item, index) {\n        return retrieveSchema(item, rootSchema, formData[index]);\n      });\n      var additionalSchema = allowAdditionalItems(schema) ? retrieveSchema(schema.additionalItems, rootSchema, formData) : null;\n\n      if (!items || items.length < itemSchemas.length) {\n        // to make sure at least all fixed items are generated\n        items = items || [];\n        items = items.concat(new Array(itemSchemas.length - items.length));\n      } // These are the props passed into the render function\n\n\n      var arrayProps = {\n        canAdd: this.canAddItem(items) && additionalSchema,\n        className: \"field field-array field-array-fixed-items\",\n        disabled: disabled,\n        idSchema: idSchema,\n        formData: formData,\n        items: this.state.keyedFormData.map(function (keyedItem, index) {\n          var key = keyedItem.key,\n              item = keyedItem.item;\n          var additional = index >= itemSchemas.length;\n          var itemSchema = additional ? retrieveSchema(schema.additionalItems, rootSchema, item) : itemSchemas[index];\n          var itemIdPrefix = idSchema.$id + \"_\" + index;\n          var itemIdSchema = toIdSchema(itemSchema, itemIdPrefix, rootSchema, item, idPrefix);\n          var itemUiSchema = additional ? uiSchema.additionalItems || {} : Array.isArray(uiSchema.items) ? uiSchema.items[index] : uiSchema.items || {};\n          var itemErrorSchema = errorSchema ? errorSchema[index] : undefined;\n          return _this3.renderArrayFieldItem({\n            key: key,\n            index: index,\n            canRemove: additional,\n            canMoveUp: index >= itemSchemas.length + 1,\n            canMoveDown: additional && index < items.length - 1,\n            itemSchema: itemSchema,\n            itemData: item,\n            itemUiSchema: itemUiSchema,\n            itemIdSchema: itemIdSchema,\n            itemErrorSchema: itemErrorSchema,\n            autofocus: autofocus && index === 0,\n            onBlur: onBlur,\n            onFocus: onFocus\n          });\n        }),\n        onAddClick: this.onAddClick,\n        readonly: readonly,\n        required: required,\n        schema: schema,\n        uiSchema: uiSchema,\n        title: title,\n        TitleField: TitleField,\n        formContext: formContext,\n        rawErrors: rawErrors\n      }; // Check if a custom template template was passed in\n\n      var Template = uiSchema[\"ui:ArrayFieldTemplate\"] || ArrayFieldTemplate || DefaultFixedArrayFieldTemplate;\n      return React.createElement(Template, arrayProps);\n    }\n  }, {\n    key: \"renderArrayFieldItem\",\n    value: function renderArrayFieldItem(props) {\n      var key = props.key,\n          index = props.index,\n          _props$canRemove = props.canRemove,\n          canRemove = _props$canRemove === void 0 ? true : _props$canRemove,\n          _props$canMoveUp = props.canMoveUp,\n          canMoveUp = _props$canMoveUp === void 0 ? true : _props$canMoveUp,\n          _props$canMoveDown = props.canMoveDown,\n          canMoveDown = _props$canMoveDown === void 0 ? true : _props$canMoveDown,\n          itemSchema = props.itemSchema,\n          itemData = props.itemData,\n          itemUiSchema = props.itemUiSchema,\n          itemIdSchema = props.itemIdSchema,\n          itemErrorSchema = props.itemErrorSchema,\n          autofocus = props.autofocus,\n          onBlur = props.onBlur,\n          onFocus = props.onFocus,\n          rawErrors = props.rawErrors;\n      var _this$props9 = this.props,\n          disabled = _this$props9.disabled,\n          readonly = _this$props9.readonly,\n          uiSchema = _this$props9.uiSchema,\n          _this$props9$registry = _this$props9.registry,\n          registry = _this$props9$registry === void 0 ? getDefaultRegistry() : _this$props9$registry;\n      var SchemaField = registry.fields.SchemaField;\n\n      var _orderable$removable$ = _objectSpread({\n        orderable: true,\n        removable: true\n      }, uiSchema[\"ui:options\"]),\n          orderable = _orderable$removable$.orderable,\n          removable = _orderable$removable$.removable;\n\n      var has = {\n        moveUp: orderable && canMoveUp,\n        moveDown: orderable && canMoveDown,\n        remove: removable && canRemove\n      };\n      has.toolbar = Object.keys(has).some(function (key) {\n        return has[key];\n      });\n      return {\n        children: React.createElement(SchemaField, {\n          index: index,\n          schema: itemSchema,\n          uiSchema: itemUiSchema,\n          formData: itemData,\n          errorSchema: itemErrorSchema,\n          idSchema: itemIdSchema,\n          required: this.isItemRequired(itemSchema),\n          onChange: this.onChangeForIndex(index),\n          onBlur: onBlur,\n          onFocus: onFocus,\n          registry: this.props.registry,\n          disabled: this.props.disabled,\n          readonly: this.props.readonly,\n          autofocus: autofocus,\n          rawErrors: rawErrors\n        }),\n        className: \"array-item\",\n        disabled: disabled,\n        hasToolbar: has.toolbar,\n        hasMoveUp: has.moveUp,\n        hasMoveDown: has.moveDown,\n        hasRemove: has.remove,\n        index: index,\n        key: key,\n        onAddIndexClick: this.onAddIndexClick,\n        onDropIndexClick: this.onDropIndexClick,\n        onReorderClick: this.onReorderClick,\n        readonly: readonly\n      };\n    }\n  }, {\n    key: \"itemTitle\",\n    get: function get() {\n      var schema = this.props.schema;\n      return schema.items.title || schema.items.description || \"Item\";\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      // Don't call getDerivedStateFromProps if keyed formdata was just updated.\n      if (prevState.updatedKeyedFormData) {\n        return {\n          updatedKeyedFormData: false\n        };\n      }\n\n      var nextFormData = nextProps.formData || [];\n      var previousKeyedFormData = prevState.keyedFormData || [];\n      var newKeyedFormData = nextFormData.length === previousKeyedFormData.length ? previousKeyedFormData.map(function (previousKeyedFormDatum, index) {\n        return {\n          key: previousKeyedFormDatum.key,\n          item: nextFormData[index]\n        };\n      }) : generateKeyedFormData(nextFormData);\n      return {\n        keyedFormData: newKeyedFormData\n      };\n    }\n  }]);\n\n  return ArrayField;\n}(Component);\n\n_defineProperty(ArrayField, \"defaultProps\", {\n  uiSchema: {},\n  formData: [],\n  idSchema: {},\n  required: false,\n  disabled: false,\n  readonly: false,\n  autofocus: false\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  ArrayField.propTypes = types.fieldProps;\n}\n\nexport default ArrayField;","map":{"version":3,"mappings":"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","names":["AddButton","IconButton","React","Component","includes","types","getWidget","getDefaultFormState","getUiOptions","isMultiSelect","isFilesArray","isFixedItems","allowAdditionalItems","optionsList","retrieveSchema","toIdSchema","getDefaultRegistry","nanoid","ArrayFieldTitle","TitleField","idSchema","title","required","id","$id","ArrayFieldDescription","DescriptionField","description","DefaultArrayItem","props","btnStyle","flex","paddingLeft","paddingRight","fontWeight","key","className","hasToolbar","children","style","display","justifyContent","hasMoveUp","hasMoveDown","icon","tabIndex","disabled","readonly","onClick","onReorderClick","index","hasRemove","type","onDropIndexClick","DefaultFixedArrayFieldTemplate","uiSchema","schema","items","map","canAdd","onAddClick","DefaultNormalArrayFieldTemplate","p","generateRowId","generateKeyedFormData","formData","Array","isArray","item","keyedToPlainFormData","keyedFormData","keyedItem","ArrayField","_classCallCheck","_this","_defineProperty","registry","rootSchema","itemSchema","additionalItems","undefined","event","preventDefault","onChange","newKeyedFormDataRow","_getNewFormDataRow","newKeyedFormData","state","setState","updatedKeyedFormData","splice","newErrorSchema","errorSchema","i","parseInt","filter","_","newIndex","target","blur","reOrderArray","_newKeyedFormData","slice","value","newFormData","jsonValue","formItems","addable","maxItems","length","hasOwnProperty","fields","UnsupportedField","reason","renderFixedArray","renderFiles","renderMultiSelect","renderNormalArray","name","autofocus","onBlur","onFocus","idPrefix","rawErrors","ArrayFieldTemplate","formContext","itemsSchema","arrayProps","canAddItem","itemErrorSchema","itemIdPrefix","itemIdSchema","_this2","renderArrayFieldItem","canMoveUp","canMoveDown","itemData","itemUiSchema","placeholder","widgets","enumOptions","widget","options","Widget","multiple","onSelectChange","label","itemSchemas","additionalSchema","concat","additional","_this3","canRemove","Template","SchemaField","orderable","removable","has","moveUp","moveDown","remove","toolbar","Object","keys","some","isItemRequired","onChangeForIndex","onAddIndexClick","nextProps","prevState","nextFormData","previousKeyedFormData","previousKeyedFormDatum","process","env","NODE_ENV","propTypes","fieldProps"],"sources":["/core/src/components/fields/ArrayField.js"],"sourcesContent":["import AddButton from \"../AddButton\";\nimport IconButton from \"../IconButton\";\nimport React, { Component } from \"react\";\nimport includes from \"core-js-pure/es/array/includes\";\nimport * as types from \"../../types\";\n\nimport {\n  getWidget,\n  getDefaultFormState,\n  getUiOptions,\n  isMultiSelect,\n  isFilesArray,\n  isFixedItems,\n  allowAdditionalItems,\n  optionsList,\n  retrieveSchema,\n  toIdSchema,\n  getDefaultRegistry,\n} from \"../../utils\";\nimport { nanoid } from \"nanoid\";\n\nfunction ArrayFieldTitle({ TitleField, idSchema, title, required }) {\n  if (!title) {\n    return null;\n  }\n  const id = `${idSchema.$id}__title`;\n  return <TitleField id={id} title={title} required={required} />;\n}\n\nfunction ArrayFieldDescription({ DescriptionField, idSchema, description }) {\n  if (!description) {\n    return null;\n  }\n  const id = `${idSchema.$id}__description`;\n  return <DescriptionField id={id} description={description} />;\n}\n\n// Used in the two templates\nfunction DefaultArrayItem(props) {\n  const btnStyle = {\n    flex: 1,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"bold\",\n  };\n  return (\n    <div key={props.key} className={props.className}>\n      <div className={props.hasToolbar ? \"col-xs-9\" : \"col-xs-12\"}>\n        {props.children}\n      </div>\n\n      {props.hasToolbar && (\n        <div className=\"col-xs-3 array-item-toolbox\">\n          <div\n            className=\"btn-group\"\n            style={{\n              display: \"flex\",\n              justifyContent: \"space-around\",\n            }}>\n            {(props.hasMoveUp || props.hasMoveDown) && (\n              <IconButton\n                icon=\"arrow-up\"\n                aria-label=\"Move up\"\n                className=\"array-item-move-up\"\n                tabIndex=\"-1\"\n                style={btnStyle}\n                disabled={props.disabled || props.readonly || !props.hasMoveUp}\n                onClick={props.onReorderClick(props.index, props.index - 1)}\n              />\n            )}\n\n            {(props.hasMoveUp || props.hasMoveDown) && (\n              <IconButton\n                icon=\"arrow-down\"\n                className=\"array-item-move-down\"\n                aria-label=\"Move down\"\n                tabIndex=\"-1\"\n                style={btnStyle}\n                disabled={\n                  props.disabled || props.readonly || !props.hasMoveDown\n                }\n                onClick={props.onReorderClick(props.index, props.index + 1)}\n              />\n            )}\n\n            {props.hasRemove && (\n              <IconButton\n                type=\"danger\"\n                icon=\"remove\"\n                aria-label=\"Remove\"\n                className=\"array-item-remove\"\n                tabIndex=\"-1\"\n                style={btnStyle}\n                disabled={props.disabled || props.readonly}\n                onClick={props.onDropIndexClick(props.index)}\n              />\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction DefaultFixedArrayFieldTemplate(props) {\n  return (\n    <fieldset className={props.className} id={props.idSchema.$id}>\n      <ArrayFieldTitle\n        key={`array-field-title-${props.idSchema.$id}`}\n        TitleField={props.TitleField}\n        idSchema={props.idSchema}\n        title={props.uiSchema[\"ui:title\"] || props.title}\n        required={props.required}\n      />\n\n      {(props.uiSchema[\"ui:description\"] || props.schema.description) && (\n        <div\n          className=\"field-description\"\n          key={`field-description-${props.idSchema.$id}`}>\n          {props.uiSchema[\"ui:description\"] || props.schema.description}\n        </div>\n      )}\n\n      <div\n        className=\"row array-item-list\"\n        key={`array-item-list-${props.idSchema.$id}`}>\n        {props.items && props.items.map(DefaultArrayItem)}\n      </div>\n\n      {props.canAdd && (\n        <AddButton\n          className=\"array-item-add\"\n          onClick={props.onAddClick}\n          disabled={props.disabled || props.readonly}\n        />\n      )}\n    </fieldset>\n  );\n}\n\nfunction DefaultNormalArrayFieldTemplate(props) {\n  return (\n    <fieldset className={props.className} id={props.idSchema.$id}>\n      <ArrayFieldTitle\n        key={`array-field-title-${props.idSchema.$id}`}\n        TitleField={props.TitleField}\n        idSchema={props.idSchema}\n        title={props.uiSchema[\"ui:title\"] || props.title}\n        required={props.required}\n      />\n\n      {(props.uiSchema[\"ui:description\"] || props.schema.description) && (\n        <ArrayFieldDescription\n          key={`array-field-description-${props.idSchema.$id}`}\n          DescriptionField={props.DescriptionField}\n          idSchema={props.idSchema}\n          description={\n            props.uiSchema[\"ui:description\"] || props.schema.description\n          }\n        />\n      )}\n\n      <div\n        className=\"row array-item-list\"\n        key={`array-item-list-${props.idSchema.$id}`}>\n        {props.items && props.items.map(p => DefaultArrayItem(p))}\n      </div>\n\n      {props.canAdd && (\n        <AddButton\n          className=\"array-item-add\"\n          onClick={props.onAddClick}\n          disabled={props.disabled || props.readonly}\n        />\n      )}\n    </fieldset>\n  );\n}\n\nfunction generateRowId() {\n  return nanoid();\n}\n\nfunction generateKeyedFormData(formData) {\n  return !Array.isArray(formData)\n    ? []\n    : formData.map(item => {\n        return {\n          key: generateRowId(),\n          item,\n        };\n      });\n}\n\nfunction keyedToPlainFormData(keyedFormData) {\n  return keyedFormData.map(keyedItem => keyedItem.item);\n}\n\nclass ArrayField extends Component {\n  static defaultProps = {\n    uiSchema: {},\n    formData: [],\n    idSchema: {},\n    required: false,\n    disabled: false,\n    readonly: false,\n    autofocus: false,\n  };\n\n  constructor(props) {\n    super(props);\n    const { formData } = props;\n    const keyedFormData = generateKeyedFormData(formData);\n    this.state = {\n      keyedFormData,\n      updatedKeyedFormData: false,\n    };\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    // Don't call getDerivedStateFromProps if keyed formdata was just updated.\n    if (prevState.updatedKeyedFormData) {\n      return {\n        updatedKeyedFormData: false,\n      };\n    }\n    const nextFormData = nextProps.formData || [];\n    const previousKeyedFormData = prevState.keyedFormData || [];\n    const newKeyedFormData =\n      nextFormData.length === previousKeyedFormData.length\n        ? previousKeyedFormData.map((previousKeyedFormDatum, index) => {\n            return {\n              key: previousKeyedFormDatum.key,\n              item: nextFormData[index],\n            };\n          })\n        : generateKeyedFormData(nextFormData);\n    return {\n      keyedFormData: newKeyedFormData,\n    };\n  }\n\n  get itemTitle() {\n    const { schema } = this.props;\n    return schema.items.title || schema.items.description || \"Item\";\n  }\n\n  isItemRequired(itemSchema) {\n    if (Array.isArray(itemSchema.type)) {\n      // While we don't yet support composite/nullable jsonschema types, it's\n      // future-proof to check for requirement against these.\n      return !includes(itemSchema.type, \"null\");\n    }\n    // All non-null array item types are inherently required by design\n    return itemSchema.type !== \"null\";\n  }\n\n  canAddItem(formItems) {\n    const { schema, uiSchema } = this.props;\n    let { addable } = getUiOptions(uiSchema);\n    if (addable !== false) {\n      // if ui:options.addable was not explicitly set to false, we can add\n      // another item if we have not exceeded maxItems yet\n      if (schema.maxItems !== undefined) {\n        addable = formItems.length < schema.maxItems;\n      } else {\n        addable = true;\n      }\n    }\n    return addable;\n  }\n\n  _getNewFormDataRow = () => {\n    const { schema, registry = getDefaultRegistry() } = this.props;\n    const { rootSchema } = registry;\n    let itemSchema = schema.items;\n    if (isFixedItems(schema) && allowAdditionalItems(schema)) {\n      itemSchema = schema.additionalItems;\n    }\n    return getDefaultFormState(itemSchema, undefined, rootSchema);\n  };\n\n  onAddClick = event => {\n    if (event) {\n      event.preventDefault();\n    }\n\n    const { onChange } = this.props;\n    const newKeyedFormDataRow = {\n      key: generateRowId(),\n      item: this._getNewFormDataRow(),\n    };\n    const newKeyedFormData = [...this.state.keyedFormData, newKeyedFormDataRow];\n    this.setState(\n      {\n        keyedFormData: newKeyedFormData,\n        updatedKeyedFormData: true,\n      },\n      () => onChange(keyedToPlainFormData(newKeyedFormData))\n    );\n  };\n\n  onAddIndexClick = index => {\n    return event => {\n      if (event) {\n        event.preventDefault();\n      }\n      const { onChange } = this.props;\n      const newKeyedFormDataRow = {\n        key: generateRowId(),\n        item: this._getNewFormDataRow(),\n      };\n      let newKeyedFormData = [...this.state.keyedFormData];\n      newKeyedFormData.splice(index, 0, newKeyedFormDataRow);\n\n      this.setState(\n        {\n          keyedFormData: newKeyedFormData,\n          updatedKeyedFormData: true,\n        },\n        () => onChange(keyedToPlainFormData(newKeyedFormData))\n      );\n    };\n  };\n\n  onDropIndexClick = index => {\n    return event => {\n      if (event) {\n        event.preventDefault();\n      }\n      const { onChange } = this.props;\n      const { keyedFormData } = this.state;\n      // refs #195: revalidate to ensure properly reindexing errors\n      let newErrorSchema;\n      if (this.props.errorSchema) {\n        newErrorSchema = {};\n        const errorSchema = this.props.errorSchema;\n        for (let i in errorSchema) {\n          i = parseInt(i);\n          if (i < index) {\n            newErrorSchema[i] = errorSchema[i];\n          } else if (i > index) {\n            newErrorSchema[i - 1] = errorSchema[i];\n          }\n        }\n      }\n      const newKeyedFormData = keyedFormData.filter((_, i) => i !== index);\n      this.setState(\n        {\n          keyedFormData: newKeyedFormData,\n          updatedKeyedFormData: true,\n        },\n        () => onChange(keyedToPlainFormData(newKeyedFormData), newErrorSchema)\n      );\n    };\n  };\n\n  onReorderClick = (index, newIndex) => {\n    return event => {\n      if (event) {\n        event.preventDefault();\n        event.target.blur();\n      }\n      const { onChange } = this.props;\n      let newErrorSchema;\n      if (this.props.errorSchema) {\n        newErrorSchema = {};\n        const errorSchema = this.props.errorSchema;\n        for (let i in errorSchema) {\n          if (i == index) {\n            newErrorSchema[newIndex] = errorSchema[index];\n          } else if (i == newIndex) {\n            newErrorSchema[index] = errorSchema[newIndex];\n          } else {\n            newErrorSchema[i] = errorSchema[i];\n          }\n        }\n      }\n\n      const { keyedFormData } = this.state;\n      function reOrderArray() {\n        // Copy item\n        let _newKeyedFormData = keyedFormData.slice();\n\n        // Moves item from index to newIndex\n        _newKeyedFormData.splice(index, 1);\n        _newKeyedFormData.splice(newIndex, 0, keyedFormData[index]);\n\n        return _newKeyedFormData;\n      }\n      const newKeyedFormData = reOrderArray();\n      this.setState(\n        {\n          keyedFormData: newKeyedFormData,\n        },\n        () => onChange(keyedToPlainFormData(newKeyedFormData), newErrorSchema)\n      );\n    };\n  };\n\n  onChangeForIndex = index => {\n    return (value, errorSchema) => {\n      const { formData, onChange } = this.props;\n      const newFormData = formData.map((item, i) => {\n        // We need to treat undefined items as nulls to have validation.\n        // See https://github.com/tdegrunt/jsonschema/issues/206\n        const jsonValue = typeof value === \"undefined\" ? null : value;\n        return index === i ? jsonValue : item;\n      });\n      onChange(\n        newFormData,\n        errorSchema &&\n          this.props.errorSchema && {\n            ...this.props.errorSchema,\n            [index]: errorSchema,\n          }\n      );\n    };\n  };\n\n  onSelectChange = value => {\n    this.props.onChange(value);\n  };\n\n  render() {\n    const {\n      schema,\n      uiSchema,\n      idSchema,\n      registry = getDefaultRegistry(),\n    } = this.props;\n    const { rootSchema } = registry;\n    if (!schema.hasOwnProperty(\"items\")) {\n      const { fields } = registry;\n      const { UnsupportedField } = fields;\n\n      return (\n        <UnsupportedField\n          schema={schema}\n          idSchema={idSchema}\n          reason=\"Missing items definition\"\n        />\n      );\n    }\n    if (isFixedItems(schema)) {\n      return this.renderFixedArray();\n    }\n    if (isFilesArray(schema, uiSchema, rootSchema)) {\n      return this.renderFiles();\n    }\n    if (isMultiSelect(schema, rootSchema)) {\n      return this.renderMultiSelect();\n    }\n    return this.renderNormalArray();\n  }\n\n  renderNormalArray() {\n    const {\n      schema,\n      uiSchema,\n      errorSchema,\n      idSchema,\n      name,\n      required,\n      disabled,\n      readonly,\n      autofocus,\n      registry = getDefaultRegistry(),\n      onBlur,\n      onFocus,\n      idPrefix,\n      rawErrors,\n    } = this.props;\n    const title = schema.title === undefined ? name : schema.title;\n    const { ArrayFieldTemplate, rootSchema, fields, formContext } = registry;\n    const { TitleField, DescriptionField } = fields;\n    const itemsSchema = retrieveSchema(schema.items, rootSchema);\n    const formData = keyedToPlainFormData(this.state.keyedFormData);\n    const arrayProps = {\n      canAdd: this.canAddItem(formData),\n      items: this.state.keyedFormData.map((keyedItem, index) => {\n        const { key, item } = keyedItem;\n        const itemSchema = retrieveSchema(schema.items, rootSchema, item);\n        const itemErrorSchema = errorSchema ? errorSchema[index] : undefined;\n        const itemIdPrefix = idSchema.$id + \"_\" + index;\n        const itemIdSchema = toIdSchema(\n          itemSchema,\n          itemIdPrefix,\n          rootSchema,\n          item,\n          idPrefix\n        );\n        return this.renderArrayFieldItem({\n          key,\n          index,\n          canMoveUp: index > 0,\n          canMoveDown: index < formData.length - 1,\n          itemSchema: itemSchema,\n          itemIdSchema,\n          itemErrorSchema,\n          itemData: item,\n          itemUiSchema: uiSchema.items,\n          autofocus: autofocus && index === 0,\n          onBlur,\n          onFocus,\n        });\n      }),\n      className: `field field-array field-array-of-${itemsSchema.type}`,\n      DescriptionField,\n      disabled,\n      idSchema,\n      uiSchema,\n      onAddClick: this.onAddClick,\n      readonly,\n      required,\n      schema,\n      title,\n      TitleField,\n      formContext,\n      formData,\n      rawErrors,\n      registry,\n    };\n\n    // Check if a custom render function was passed in\n    const Component =\n      uiSchema[\"ui:ArrayFieldTemplate\"] ||\n      ArrayFieldTemplate ||\n      DefaultNormalArrayFieldTemplate;\n    return <Component {...arrayProps} />;\n  }\n\n  renderMultiSelect() {\n    const {\n      schema,\n      idSchema,\n      uiSchema,\n      formData,\n      disabled,\n      readonly,\n      required,\n      placeholder,\n      autofocus,\n      onBlur,\n      onFocus,\n      registry = getDefaultRegistry(),\n      rawErrors,\n      name,\n    } = this.props;\n    const items = this.props.formData;\n    const { widgets, rootSchema, formContext } = registry;\n    const itemsSchema = retrieveSchema(schema.items, rootSchema, formData);\n    const title = schema.title || name;\n    const enumOptions = optionsList(itemsSchema);\n    const { widget = \"select\", ...options } = {\n      ...getUiOptions(uiSchema),\n      enumOptions,\n    };\n    const Widget = getWidget(schema, widget, widgets);\n    return (\n      <Widget\n        id={idSchema && idSchema.$id}\n        multiple\n        onChange={this.onSelectChange}\n        onBlur={onBlur}\n        onFocus={onFocus}\n        options={options}\n        schema={schema}\n        registry={registry}\n        value={items}\n        disabled={disabled}\n        readonly={readonly}\n        required={required}\n        label={title}\n        placeholder={placeholder}\n        formContext={formContext}\n        autofocus={autofocus}\n        rawErrors={rawErrors}\n      />\n    );\n  }\n\n  renderFiles() {\n    const {\n      schema,\n      uiSchema,\n      idSchema,\n      name,\n      disabled,\n      readonly,\n      autofocus,\n      onBlur,\n      onFocus,\n      registry = getDefaultRegistry(),\n      rawErrors,\n    } = this.props;\n    const title = schema.title || name;\n    const items = this.props.formData;\n    const { widgets, formContext } = registry;\n    const { widget = \"files\", ...options } = getUiOptions(uiSchema);\n    const Widget = getWidget(schema, widget, widgets);\n    return (\n      <Widget\n        options={options}\n        id={idSchema && idSchema.$id}\n        multiple\n        onChange={this.onSelectChange}\n        onBlur={onBlur}\n        onFocus={onFocus}\n        schema={schema}\n        title={title}\n        value={items}\n        disabled={disabled}\n        readonly={readonly}\n        formContext={formContext}\n        autofocus={autofocus}\n        rawErrors={rawErrors}\n      />\n    );\n  }\n\n  renderFixedArray() {\n    const {\n      schema,\n      uiSchema,\n      formData,\n      errorSchema,\n      idPrefix,\n      idSchema,\n      name,\n      required,\n      disabled,\n      readonly,\n      autofocus,\n      registry = getDefaultRegistry(),\n      onBlur,\n      onFocus,\n      rawErrors,\n    } = this.props;\n    const title = schema.title || name;\n    let items = this.props.formData;\n    const { ArrayFieldTemplate, rootSchema, fields, formContext } = registry;\n    const { TitleField } = fields;\n    const itemSchemas = schema.items.map((item, index) =>\n      retrieveSchema(item, rootSchema, formData[index])\n    );\n    const additionalSchema = allowAdditionalItems(schema)\n      ? retrieveSchema(schema.additionalItems, rootSchema, formData)\n      : null;\n\n    if (!items || items.length < itemSchemas.length) {\n      // to make sure at least all fixed items are generated\n      items = items || [];\n      items = items.concat(new Array(itemSchemas.length - items.length));\n    }\n\n    // These are the props passed into the render function\n    const arrayProps = {\n      canAdd: this.canAddItem(items) && additionalSchema,\n      className: \"field field-array field-array-fixed-items\",\n      disabled,\n      idSchema,\n      formData,\n      items: this.state.keyedFormData.map((keyedItem, index) => {\n        const { key, item } = keyedItem;\n        const additional = index >= itemSchemas.length;\n        const itemSchema = additional\n          ? retrieveSchema(schema.additionalItems, rootSchema, item)\n          : itemSchemas[index];\n        const itemIdPrefix = idSchema.$id + \"_\" + index;\n        const itemIdSchema = toIdSchema(\n          itemSchema,\n          itemIdPrefix,\n          rootSchema,\n          item,\n          idPrefix\n        );\n        const itemUiSchema = additional\n          ? uiSchema.additionalItems || {}\n          : Array.isArray(uiSchema.items)\n          ? uiSchema.items[index]\n          : uiSchema.items || {};\n        const itemErrorSchema = errorSchema ? errorSchema[index] : undefined;\n\n        return this.renderArrayFieldItem({\n          key,\n          index,\n          canRemove: additional,\n          canMoveUp: index >= itemSchemas.length + 1,\n          canMoveDown: additional && index < items.length - 1,\n          itemSchema,\n          itemData: item,\n          itemUiSchema,\n          itemIdSchema,\n          itemErrorSchema,\n          autofocus: autofocus && index === 0,\n          onBlur,\n          onFocus,\n        });\n      }),\n      onAddClick: this.onAddClick,\n      readonly,\n      required,\n      schema,\n      uiSchema,\n      title,\n      TitleField,\n      formContext,\n      rawErrors,\n    };\n\n    // Check if a custom template template was passed in\n    const Template =\n      uiSchema[\"ui:ArrayFieldTemplate\"] ||\n      ArrayFieldTemplate ||\n      DefaultFixedArrayFieldTemplate;\n    return <Template {...arrayProps} />;\n  }\n\n  renderArrayFieldItem(props) {\n    const {\n      key,\n      index,\n      canRemove = true,\n      canMoveUp = true,\n      canMoveDown = true,\n      itemSchema,\n      itemData,\n      itemUiSchema,\n      itemIdSchema,\n      itemErrorSchema,\n      autofocus,\n      onBlur,\n      onFocus,\n      rawErrors,\n    } = props;\n    const {\n      disabled,\n      readonly,\n      uiSchema,\n      registry = getDefaultRegistry(),\n    } = this.props;\n    const {\n      fields: { SchemaField },\n    } = registry;\n    const { orderable, removable } = {\n      orderable: true,\n      removable: true,\n      ...uiSchema[\"ui:options\"],\n    };\n    const has = {\n      moveUp: orderable && canMoveUp,\n      moveDown: orderable && canMoveDown,\n      remove: removable && canRemove,\n    };\n    has.toolbar = Object.keys(has).some(key => has[key]);\n\n    return {\n      children: (\n        <SchemaField\n          index={index}\n          schema={itemSchema}\n          uiSchema={itemUiSchema}\n          formData={itemData}\n          errorSchema={itemErrorSchema}\n          idSchema={itemIdSchema}\n          required={this.isItemRequired(itemSchema)}\n          onChange={this.onChangeForIndex(index)}\n          onBlur={onBlur}\n          onFocus={onFocus}\n          registry={this.props.registry}\n          disabled={this.props.disabled}\n          readonly={this.props.readonly}\n          autofocus={autofocus}\n          rawErrors={rawErrors}\n        />\n      ),\n      className: \"array-item\",\n      disabled,\n      hasToolbar: has.toolbar,\n      hasMoveUp: has.moveUp,\n      hasMoveDown: has.moveDown,\n      hasRemove: has.remove,\n      index,\n      key,\n      onAddIndexClick: this.onAddIndexClick,\n      onDropIndexClick: this.onDropIndexClick,\n      onReorderClick: this.onReorderClick,\n      readonly,\n    };\n  }\n}\n\nif (process.env.NODE_ENV !== \"production\") {\n  ArrayField.propTypes = types.fieldProps;\n}\n\nexport default ArrayField;\n"]},"metadata":{},"sourceType":"module"}